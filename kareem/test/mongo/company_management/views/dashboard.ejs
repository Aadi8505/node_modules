<!DOCTYPE html>
<html>
<head>
  <title>Student Management</title>
  <style>
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
    button { padding: 5px 10px; }
  </style>
</head>
<body>

<h2>Student Management</h2>

<!-- ADD STUDENT -->
<form action="/addStudent" method="POST">
  <input name="name" placeholder="Name" required />
  <input name="section" placeholder="Section" required />
  <input name="marks" type="number" placeholder="Marks" required />
  <button type="submit">Add Student</button>
</form>

<br>

<!-- FILTER -->
<form action="/filter" method="POST">
  <select name="type">
    <option value="gt">Greater Than</option>
    <option value="lt">Less Than</option>
    <option value="eq">Equal To</option>
  </select>
  <input name="marks" type="number" placeholder="Marks" required />
  <button type="submit">Filter</button>
</form>

<br>

<!-- TABLE -->
<table>
  <tr>
    <th>Name</th>
    <th>Section</th>
    <th>Marks</th>
    <th>Actions</th>
  </tr>

  <% students.forEach(s => { %>
    <tr>
      <td><%= s.name %></td>
      <td><%= s.section %></td>
      <td><%= s.marks %></td>
      <td>
        <button onclick="delStudent('<%= s._id %>')">Delete</button>
        <a href="/updateStudent/<%= s._id %>">
          <button>Edit</button>
        </a>
      </td>
    </tr>
  <% }) %>
</table>

<br>

<!-- PAGINATION -->
<div>
  <% if (page > 1) { %>
    <a href="/?page=<%= page - 1 %>"><button>Prev</button></a>
  <% } %>

  Page <%= page %> of <%= totalPages %>

  <% if (page < totalPages) { %>
    <a href="/?page=<%= page + 1 %>"><button>Next</button></a>
  <% } %>
</div>

<script>
  function delStudent(id) {
    fetch(`/deleteStudent/${id}`, { method: "DELETE" })
      .then(() => location.reload());
  }
</script>

</body>
</html>
